set.seed(12)
fetal_health_subset <- read.csv("data/fetal_health_subset.csv") %>%
select(baseline.value, accelerations, fetal_movement, uterine_contractions, light_decelerations, severe_decelerations, prolongued_decelerations, abnormal_short_term_variability, mean_value_of_short_term_variability, mean_value_of_long_term_variability, fetal_health) %>%
drop_na() %>%
mutate(fetal_health_c =
factor(fetal_health))
Table_1a <- as_flex_table( tbl_summary(data= fetal_health_subset,
by=fetal_health,
type= all_continuous() ~ "continuous",
statistic= all_continuous() ~ "{mean} ({sd})",
include = c('baseline.value',
'accelerations', 'fetal_movement', 'uterine_contractions',
'light_decelerations', 'severe_decelerations', 'prolongued_decelerations', 'abnormal_short_term_variability', 'mean_value_of_short_term_variability', 'mean_value_of_long_term_variability', 'fetal_health'),
label = list(baseline.value ~ "Baseline Value",
accelerations ~ "Accelerations",
fetal_movement ~ "Fetal Movement",
uterine_contractions ~ "Uterine Contractions",
light_decelerations ~ "Light Decelerations",
severe_decelerations ~ "Severe Decelerations",
prolongued_decelerations ~ "Prolongued Decelerations",
abnormal_short_term_variability ~ "Abnormal Short Term Variability",
mean_value_of_short_term_variability ~ "Mean Value Of Short Term Variability",
mean_value_of_long_term_variability ~ "Mean Value Of Long Term Variability",
fetal_health ~ "Fetal Health" ),
missing='no')%>%
add_n() %>%
add_p(test = c(baseline.value, accelerations,
fetal_movement, uterine_contractions, light_decelerations,
severe_decelerations, prolongued_decelerations,
abnormal_short_term_variability,
mean_value_of_short_term_variability,
mean_value_of_long_term_variability) ~ "aov")) %>%
bold( bold = TRUE, part = "header")  %>%
add_header_lines(values="Summary Statistics for Fetal Health Variables of Interest")
Table_1a
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, include=TRUE,
fig.width = 10, fig.height = 5)
library(tidyverse)
library(broom)
library(gtsummary)
library(flextable)
library(gt)
library(caret)
library(GGally)
set.seed(12)
fetal_health_subset <- read.csv("data/fetal_health_subset.csv") %>%
select(baseline.value, accelerations, fetal_movement, uterine_contractions, light_decelerations, severe_decelerations, prolongued_decelerations, abnormal_short_term_variability, mean_value_of_short_term_variability, mean_value_of_long_term_variability, fetal_health) %>%
drop_na() %>%
mutate(fetal_health_c =
factor(fetal_health))
Table_1a <- as_flex_table( tbl_summary(data= fetal_health_subset,
by=fetal_health,
type= all_continuous() ~ "continuous",
statistic= all_continuous() ~ "{mean} ({sd})",
include = c('baseline.value',
'accelerations', 'fetal_movement', 'uterine_contractions',
'light_decelerations', 'severe_decelerations', 'prolongued_decelerations', 'abnormal_short_term_variability', 'mean_value_of_short_term_variability', 'mean_value_of_long_term_variability', 'fetal_health'),
label = list(baseline.value ~ "Baseline Value",
accelerations ~ "Accelerations",
fetal_movement ~ "Fetal Movement",
uterine_contractions ~ "Uterine Contractions",
light_decelerations ~ "Light Decelerations",
severe_decelerations ~ "Severe Decelerations",
prolongued_decelerations ~ "Prolongued Decelerations",
abnormal_short_term_variability ~ "Abnormal Short Term Variability",
mean_value_of_short_term_variability ~ "Mean Value Of Short Term Variability",
mean_value_of_long_term_variability ~ "Mean Value Of Long Term Variability",
fetal_health ~ "Fetal Health" ),
missing='no')%>%
add_n() %>%
add_p(test = c(baseline.value, accelerations,
fetal_movement, uterine_contractions, light_decelerations,
severe_decelerations, prolongued_decelerations,
abnormal_short_term_variability,
mean_value_of_short_term_variability,
mean_value_of_long_term_variability) ~ "aov")) %>%
bold( bold = TRUE, part = "header")  %>%
add_header_lines(values="Summary Statistics for Fetal Health Variables of Interest")
Table_1a
set.seed(12)
# Fit model on whole data to fix tuning paramater
knn_train_all_data <- train(form=fetal_health_c~., data=fetal_health_subset,
method="knn", tuneLength=20)
knn_train_all_data$bestTune
fetal_health_subset$knn_fh_pred <- predict(knn_train_all_data)
fetal_health_subset$knn_fh_pred
confusionMatrix(data=fetal_health_subset$knn_fh_pred,
reference = fetal_health_subset$fetal_health_c)
knn_train_all_data
knn_train_all_data <- train(form=fetal_health~., data=fetal_health_subset,
method="knn", tuneLength=20)
knn_train_all_data
fetal_health_subset$fetal_health
knn_train_all_data <- train(form=fetal_health_c~., data=fetal_health_subset,
method="knn", tuneLength=20)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, include=TRUE,
fig.width = 10, fig.height = 5)
library(tidyverse)
library(broom)
library(gtsummary)
library(flextable)
library(gt)
library(caret)
library(GGally)
set.seed(12)
fetal_health_subset <- read.csv("data/fetal_health_subset.csv") %>%
select(baseline.value, accelerations, fetal_movement, uterine_contractions, light_decelerations, severe_decelerations, prolongued_decelerations, abnormal_short_term_variability, mean_value_of_short_term_variability, mean_value_of_long_term_variability, fetal_health) %>%
drop_na() %>%
mutate(fetal_health_c =
factor(fetal_health))
Table_1a <- as_flex_table( tbl_summary(data= fetal_health_subset,
by=fetal_health,
type= all_continuous() ~ "continuous",
statistic= all_continuous() ~ "{mean} ({sd})",
include = c('baseline.value',
'accelerations', 'fetal_movement', 'uterine_contractions',
'light_decelerations', 'severe_decelerations', 'prolongued_decelerations', 'abnormal_short_term_variability', 'mean_value_of_short_term_variability', 'mean_value_of_long_term_variability', 'fetal_health'),
label = list(baseline.value ~ "Baseline Value",
accelerations ~ "Accelerations",
fetal_movement ~ "Fetal Movement",
uterine_contractions ~ "Uterine Contractions",
light_decelerations ~ "Light Decelerations",
severe_decelerations ~ "Severe Decelerations",
prolongued_decelerations ~ "Prolongued Decelerations",
abnormal_short_term_variability ~ "Abnormal Short Term Variability",
mean_value_of_short_term_variability ~ "Mean Value Of Short Term Variability",
mean_value_of_long_term_variability ~ "Mean Value Of Long Term Variability",
fetal_health ~ "Fetal Health" ),
missing='no')%>%
add_n() %>%
add_p(test = c(baseline.value, accelerations,
fetal_movement, uterine_contractions, light_decelerations,
severe_decelerations, prolongued_decelerations,
abnormal_short_term_variability,
mean_value_of_short_term_variability,
mean_value_of_long_term_variability) ~ "aov")) %>%
bold( bold = TRUE, part = "header")  %>%
add_header_lines(values="Summary Statistics for Fetal Health Variables of Interest")
Table_1a
per_class_accruacy <- rep(NA, length(levels(fetal_health_subset$fetal_health_c)))
for(i in 1:length(per_class_accruacy)){
per_class_accruacy[i] <-
fetal_health_subset %>%
filter(fetal_health_c==levels(fetal_health_c)[i]) %>%
summarise(accuracy = sum(knn_fh_pred==levels(fetal_health_c)[i])/n()) %>%
unlist()
names(per_class_accruacy)[i] <- paste0("accuracy_",
levels(fetal_health_subset$fetal_health_c)[i])
}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, include=TRUE,
fig.width = 10, fig.height = 5)
library(tidyverse)
library(broom)
library(gtsummary)
library(flextable)
library(gt)
library(caret)
library(GGally)
set.seed(12)
fetal_health_subset <- read.csv("data/fetal_health_subset.csv") %>%
select(baseline.value, accelerations, fetal_movement, uterine_contractions, light_decelerations, severe_decelerations, prolongued_decelerations, abnormal_short_term_variability, mean_value_of_short_term_variability, mean_value_of_long_term_variability, fetal_health) %>%
drop_na() %>%
mutate(fetal_health_c =
factor(fetal_health))
Table_1a <- as_flex_table( tbl_summary(data= fetal_health_subset,
by=fetal_health,
type= all_continuous() ~ "continuous",
statistic= all_continuous() ~ "{mean} ({sd})",
include = c('baseline.value',
'accelerations', 'fetal_movement', 'uterine_contractions',
'light_decelerations', 'severe_decelerations', 'prolongued_decelerations', 'abnormal_short_term_variability', 'mean_value_of_short_term_variability', 'mean_value_of_long_term_variability', 'fetal_health'),
label = list(baseline.value ~ "Baseline Value",
accelerations ~ "Accelerations",
fetal_movement ~ "Fetal Movement",
uterine_contractions ~ "Uterine Contractions",
light_decelerations ~ "Light Decelerations",
severe_decelerations ~ "Severe Decelerations",
prolongued_decelerations ~ "Prolongued Decelerations",
abnormal_short_term_variability ~ "Abnormal Short Term Variability",
mean_value_of_short_term_variability ~ "Mean Value Of Short Term Variability",
mean_value_of_long_term_variability ~ "Mean Value Of Long Term Variability",
fetal_health ~ "Fetal Health" ),
missing='no')%>%
add_n() %>%
add_p(test = c(baseline.value, accelerations,
fetal_movement, uterine_contractions, light_decelerations,
severe_decelerations, prolongued_decelerations,
abnormal_short_term_variability,
mean_value_of_short_term_variability,
mean_value_of_long_term_variability) ~ "aov")) %>%
bold( bold = TRUE, part = "header")  %>%
add_header_lines(values="Summary Statistics for Fetal Health Variables of Interest")
Table_1a
set.seed(12)
# Fit model on whole data to fix tuning parameter
knn_train_all_data <- train(form=fetal_health_c~., data=fetal_health_subset,
method="knn", tuneLength=20)
fetal_health_subset$knn_fh_pred <- predict(knn_train_all_data)
confusionMatrix(data=fetal_health_subset$knn_fh_pred,
reference = fetal_health_subset$fetal_health_c)
# Compute per class accuracy
per_class_accruacy <- rep(NA, length(levels(fetal_health_subset$fetal_health_c)))
for(i in 1:length(per_class_accruacy)){
per_class_accruacy[i] <-
fetal_health_subset %>%
filter(fetal_health_c==levels(fetal_health_c)[i]) %>%
summarise(accuracy = sum(knn_fh_pred==levels(fetal_health_c)[i])/n()) %>%
unlist()
names(per_class_accruacy)[i] <- paste0("accuracy_",
levels(fetal_health_subset$fetal_health_c)[i])
}
per_class_accruacy
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, include=TRUE,
fig.width = 10, fig.height = 5)
library(tidyverse)
library(broom)
library(gtsummary)
library(flextable)
library(gt)
library(caret)
library(GGally)
set.seed(12)
fetal_health_subset <- read.csv("data/fetal_health_subset.csv") %>%
select(baseline.value, accelerations, fetal_movement, uterine_contractions, light_decelerations, severe_decelerations, prolongued_decelerations, abnormal_short_term_variability, mean_value_of_short_term_variability, mean_value_of_long_term_variability, fetal_health) %>%
drop_na() %>%
mutate(fetal_health_c =
factor(fetal_health))
Table_1a <- as_flex_table( tbl_summary(data= fetal_health_subset,
by=fetal_health,
type= all_continuous() ~ "continuous",
statistic= all_continuous() ~ "{mean} ({sd})",
include = c('baseline.value',
'accelerations', 'fetal_movement', 'uterine_contractions',
'light_decelerations', 'severe_decelerations', 'prolongued_decelerations', 'abnormal_short_term_variability', 'mean_value_of_short_term_variability', 'mean_value_of_long_term_variability', 'fetal_health'),
label = list(baseline.value ~ "Baseline Value",
accelerations ~ "Accelerations",
fetal_movement ~ "Fetal Movement",
uterine_contractions ~ "Uterine Contractions",
light_decelerations ~ "Light Decelerations",
severe_decelerations ~ "Severe Decelerations",
prolongued_decelerations ~ "Prolongued Decelerations",
abnormal_short_term_variability ~ "Abnormal Short Term Variability",
mean_value_of_short_term_variability ~ "Mean Value Of Short Term Variability",
mean_value_of_long_term_variability ~ "Mean Value Of Long Term Variability",
fetal_health ~ "Fetal Health" ),
missing='no')%>%
add_n() %>%
add_p(test = c(baseline.value, accelerations,
fetal_movement, uterine_contractions, light_decelerations,
severe_decelerations, prolongued_decelerations,
abnormal_short_term_variability,
mean_value_of_short_term_variability,
mean_value_of_long_term_variability) ~ "aov")) %>%
bold( bold = TRUE, part = "header")  %>%
add_header_lines(values="Summary Statistics for Fetal Health Variables of Interest")
Table_1a
set.seed(12)
# Fit model on whole data to fix tuning parameter
knn_train_all_data <- train(form=fetal_health_c~., data=fetal_health_subset,
method="knn", tuneLength=20)
fetal_health_subset$knn_fh_pred <- predict(knn_train_all_data)
confusionMatrix(data=fetal_health_subset$knn_fh_pred,
reference = fetal_health_subset$fetal_health_c)
per_class_accruacy <- rep(NA, length(levels(fetal_health_subset$fetal_health_c)))
for(i in 1:length(per_class_accruacy)){
per_class_accruacy[i] <-
fetal_health_subset %>%
filter(fetal_health_c==levels(fetal_health_c)[i]) %>%
summarise(accuracy = sum(knn_fh_pred==levels(fetal_health_c)[i])/n()) %>%
unlist()
names(per_class_accruacy)[i] <- paste0("accuracy_",
levels(fetal_health_subset$fetal_health_c)[i])
}
per_class_accruacy
tt_indicies <- createFolds(y=fetal_health_subset$fetal_health, k=5)
fetal_health_train2 <- fetal_health_subset[-tt_indicies[[f]],]
f=1
fetal_health_train2 <- fetal_health_subset[-tt_indicies[[f]],]
fetal_health_test2 <- fetal_health_subset[tt_indicies[[f]],]
knn_train <- train(form=fetal_health_c~., data=fetal_health_train2,
method="knn", tuneLength=20)
fetal_health_test2$knn_fh_pred <- predict(knn_train)
fetal_health_train2 <- fetal_health_subset[-tt_indicies[[f]],]
fetal_health_test2 <- fetal_health_subset[tt_indicies[[f]],]
knn_train <- train(form=fetal_health_c~., data=fetal_health_train2,
method="knn", tuneLength=20)
fetal_health_test2$knn_fh_pred <- predict(knn_train, newdata=fetal_health_test2)
confusionMatrix(data=fetal_health_test2$knn_fh_pred,
reference = fetal_health_test2$fetal_health_c)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, include=TRUE,
fig.width = 10, fig.height = 5)
library(tidyverse)
library(broom)
library(gtsummary)
library(flextable)
library(gt)
library(caret)
library(GGally)
set.seed(12)
fetal_health_subset <- read.csv("data/fetal_health_subset.csv") %>%
select(baseline.value, accelerations, fetal_movement, uterine_contractions, light_decelerations, severe_decelerations, prolongued_decelerations, abnormal_short_term_variability, mean_value_of_short_term_variability, mean_value_of_long_term_variability, fetal_health) %>%
drop_na() %>%
mutate(fetal_health_c =
factor(fetal_health))
Table_1a <- as_flex_table( tbl_summary(data= fetal_health_subset,
by=fetal_health,
type= all_continuous() ~ "continuous",
statistic= all_continuous() ~ "{mean} ({sd})",
include = c('baseline.value',
'accelerations', 'fetal_movement', 'uterine_contractions',
'light_decelerations', 'severe_decelerations', 'prolongued_decelerations', 'abnormal_short_term_variability', 'mean_value_of_short_term_variability', 'mean_value_of_long_term_variability', 'fetal_health'),
label = list(baseline.value ~ "Baseline Value",
accelerations ~ "Accelerations",
fetal_movement ~ "Fetal Movement",
uterine_contractions ~ "Uterine Contractions",
light_decelerations ~ "Light Decelerations",
severe_decelerations ~ "Severe Decelerations",
prolongued_decelerations ~ "Prolongued Decelerations",
abnormal_short_term_variability ~ "Abnormal Short Term Variability",
mean_value_of_short_term_variability ~ "Mean Value Of Short Term Variability",
mean_value_of_long_term_variability ~ "Mean Value Of Long Term Variability",
fetal_health ~ "Fetal Health" ),
missing='no')%>%
add_n() %>%
add_p(test = c(baseline.value, accelerations,
fetal_movement, uterine_contractions, light_decelerations,
severe_decelerations, prolongued_decelerations,
abnormal_short_term_variability,
mean_value_of_short_term_variability,
mean_value_of_long_term_variability) ~ "aov")) %>%
bold( bold = TRUE, part = "header")  %>%
add_header_lines(values="Summary Statistics for Fetal Health Variables of Interest")
Table_1a
set.seed(12)
tt_indicies <- createDataPartition(y=fetal_health_subset$fetal_health, p=0.6,
list=FALSE)
tt_indicies
fetal_health_train2 <- fetal_health_subset[tt_indicies,]
fetal_health_test2 <- fetal_health_subset[-tt_indicies,]
knn_train <- train(form=fetal_health_c~., data=fetal_health_train2,
method="knn", tuneLength=20)
set.seed(12)
for(i in 1:100){
print(i)
tt_indicies <- createDataPartition(y=fetal_health_subset$fetal_health, p=0.6,
list=FALSE)
fetal_health_train2 <- fetal_health_subset[tt_indicies,]
fetal_health_test2 <- fetal_health_subset[-tt_indicies,]
knn_train <- train(form=fetal_health_c~., data=fetal_health_train2,
method="knn", tuneLength=20)
}
set.seed(12)
for(i in 1:10){
tt_indicies <- createDataPartition(y=fetal_health_subset$fetal_health, p=0.6,
list=FALSE)
fetal_health_train2 <- fetal_health_subset[tt_indicies,]
fetal_health_test2 <- fetal_health_subset[-tt_indicies,]
knn_train <- train(form=fetal_health_c~., data=fetal_health_train2,
method="knn", tuneLength=20)
}
set.seed(12)
start <- system.time()
start <- system.time()
?system.time
sys.time()
start <- proc.time()
start
set.seed(12)
start <- proc.time()
for(i in 1:10){
tt_indicies <- createDataPartition(y=fetal_health_subset$fetal_health, p=0.6,
list=FALSE)
fetal_health_train2 <- fetal_health_subset[tt_indicies,]
fetal_health_test2 <- fetal_health_subset[-tt_indicies,]
knn_train <- train(form=fetal_health_c~., data=fetal_health_train2,
method="knn", tuneLength=20)
}
proc.time()-start
?train
set.seed(12)
# Create 5 folds
tt_indicies <- createFolds(y=fetal_health_subset$fetal_health, k=200)
for(f in 1:length(tt_indicies)){
print(f)
fetal_health_train2 <- fetal_health_subset[-tt_indicies[[f]],]
fetal_health_test2 <- fetal_health_subset[tt_indicies[[f]],]
knn_train <- train(form=fetal_health_c~., data=fetal_health_train2,
method="knn", tuneLength=5,
trControl = trainControl(method="cv", number=5))
fetal_health_test2$knn_fh_pred <- predict(knn_train, newdata=fetal_health_test2)
confusionMatrix(data=fetal_health_test2$knn_fh_pred,
reference = fetal_health_test2$fetal_health_c)
# Compute per class accuracy
per_class_accruacy <- rep(NA, length(levels(fetal_health_subset$fetal_health_c)))
for(i in 1:length(per_class_accruacy)){
per_class_accruacy[i] <-
fetal_health_subset %>%
filter(fetal_health_c==levels(fetal_health_c)[i]) %>%
summarise(accuracy = sum(knn_fh_pred==levels(fetal_health_c)[i])/n()) %>%
unlist()
names(per_class_accruacy)[i] <- paste0("accuracy_",
levels(fetal_health_subset$fetal_health_c)[i])
}
}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, include=TRUE,
fig.width = 10, fig.height = 5)
library(tidyverse)
library(broom)
library(gtsummary)
library(flextable)
library(gt)
library(caret)
library(GGally)
set.seed(12)
fetal_health_subset <- read.csv("data/fetal_health_subset.csv") %>%
select(baseline.value, accelerations, fetal_movement, uterine_contractions, light_decelerations, severe_decelerations, prolongued_decelerations, abnormal_short_term_variability, mean_value_of_short_term_variability, mean_value_of_long_term_variability, fetal_health) %>%
drop_na() %>%
mutate(fetal_health_c =
factor(fetal_health))
Table_1a <- as_flex_table( tbl_summary(data= fetal_health_subset,
by=fetal_health,
type= all_continuous() ~ "continuous",
statistic= all_continuous() ~ "{mean} ({sd})",
include = c('baseline.value',
'accelerations', 'fetal_movement', 'uterine_contractions',
'light_decelerations', 'severe_decelerations', 'prolongued_decelerations', 'abnormal_short_term_variability', 'mean_value_of_short_term_variability', 'mean_value_of_long_term_variability', 'fetal_health'),
label = list(baseline.value ~ "Baseline Value",
accelerations ~ "Accelerations",
fetal_movement ~ "Fetal Movement",
uterine_contractions ~ "Uterine Contractions",
light_decelerations ~ "Light Decelerations",
severe_decelerations ~ "Severe Decelerations",
prolongued_decelerations ~ "Prolongued Decelerations",
abnormal_short_term_variability ~ "Abnormal Short Term Variability",
mean_value_of_short_term_variability ~ "Mean Value Of Short Term Variability",
mean_value_of_long_term_variability ~ "Mean Value Of Long Term Variability",
fetal_health ~ "Fetal Health" ),
missing='no')%>%
add_n() %>%
add_p(test = c(baseline.value, accelerations,
fetal_movement, uterine_contractions, light_decelerations,
severe_decelerations, prolongued_decelerations,
abnormal_short_term_variability,
mean_value_of_short_term_variability,
mean_value_of_long_term_variability) ~ "aov")) %>%
bold( bold = TRUE, part = "header")  %>%
add_header_lines(values="Summary Statistics for Fetal Health Variables of Interest")
Table_1a
set.seed(12)
start <- proc.time()
for(i in 1:10){
tt_indicies <- createDataPartition(y=fetal_health_subset$fetal_health, p=0.6,
list=FALSE)
fetal_health_train2 <- fetal_health_subset[tt_indicies,]
fetal_health_test2 <- fetal_health_subset[-tt_indicies,]
knn_train <- train(form=fetal_health_c~., data=fetal_health_train2,
method="knn", tuneLength=20)
}
proc.time()-start
set.seed(12)
# Create 5 folds
tt_indicies <- createFolds(y=fetal_health_subset$fetal_health, k=5)
f=1
print(f)
fetal_health_train2 <- fetal_health_subset[-tt_indicies[[f]],]
fetal_health_test2 <- fetal_health_subset[tt_indicies[[f]],]
knn_train <- train(form=fetal_health_c~., data=fetal_health_train2,
method="knn", tuneLength=5,
trControl = trainControl(method="cv", number=5))
fetal_health_test2$knn_fh_pred <- predict(knn_train, newdata=fetal_health_test2)
confusionMatrix(data=fetal_health_test2$knn_fh_pred,
reference = fetal_health_test2$fetal_health_c)
# Compute per class accuracy
per_class_accruacy <- rep(NA, length(levels(fetal_health_subset$fetal_health_c)))
confusionMatrix(data=fetal_health_test2$knn_fh_pred,
reference = fetal_health_test2$fetal_health_c)$byClass
View(confusionMatrix(data=fetal_health_test2$knn_fh_pred,
reference = fetal_health_test2$fetal_health_c)$byClass)
# Compute per class accuracy
per_class_accruacy <- rep(NA, length(levels(fetal_health_subset$fetal_health_c)))
for(i in 1:length(per_class_accruacy)){
per_class_accruacy[i] <-
fetal_health_subset %>%
filter(fetal_health_c==levels(fetal_health_c)[i]) %>%
summarise(accuracy = sum(knn_fh_pred==levels(fetal_health_c)[i])/n()) %>%
unlist()
names(per_class_accruacy)[i] <- paste0("accuracy_",
levels(fetal_health_subset$fetal_health_c)[i])
}
View(fetal_health_subset)
per_class_accruacy <- rep(NA, length(levels(fetal_health_subset$fetal_health_c)))
for(i in 1:length(per_class_accruacy)){
per_class_accruacy[i] <-
per_class_accruacy %>%
filter(fetal_health_c==levels(fetal_health_c)[i]) %>%
summarise(accuracy = sum(knn_fh_pred==levels(fetal_health_c)[i])/n()) %>%
unlist()
names(per_class_accruacy)[i] <- paste0("accuracy_",
levels(fetal_health_subset$fetal_health_c)[i])
}
per_class_accruacy <- rep(NA, length(levels(fetal_health_subset$fetal_health_c)))
per_class_accruacy <- rep(NA, length(levels(fetal_health_subset$fetal_health_c)))
for(i in 1:length(per_class_accruacy)){
per_class_accruacy[i] <-
fetal_health_test2 %>%
filter(fetal_health_c==levels(fetal_health_c)[i]) %>%
summarise(accuracy = sum(knn_fh_pred==levels(fetal_health_c)[i])/n()) %>%
unlist()
names(per_class_accruacy)[i] <- paste0("accuracy_",
levels(fetal_health_subset$fetal_health_c)[i])
}
per_class_accruacy
