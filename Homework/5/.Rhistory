knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, include=TRUE,
fig.width = 10, fig.height = 5)
library(tidyverse)
library(broom)
library(gtsummary)
library(flextable)
library(gt)
library(caret)
library(GGally)
library(mgcv)
library(splines)
data <- read_csv("data/real_estate_db.csv")
data <- read_csv("data/real_estate_db.csv") %>%
select(state, city, place, pop, rent_median, debt, pct_own, male_age_mean,
female_age_mean, male_pop, female_pop)
View(data)
apply(data, MARGIN = 2, FUN=function(x){sum(is.na(x))})
data <- read_csv("data/real_estate_db.csv") %>%
select(state, city, place, pop, rent_median, debt, pct_own, male_age_mean,
female_age_mean, male_pop, female_pop) %>%
complete()
apply(data, MARGIN = 2, FUN=function(x){sum(is.na(x))}) %
apply(data, MARGIN = 2, FUN=function(x){sum(is.na(x))})
?complete.cases
?complete
?drop_na
data <- read_csv("data/real_estate_db.csv") %>%
select(state, city, place, pop, rent_median, debt, pct_own, male_age_mean,
female_age_mean, male_pop, female_pop) %>%
drop_na()
apply(data, MARGIN = 2, FUN=function(x){sum(is.na(x))})
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, include=TRUE,
fig.width = 10, fig.height = 5)
library(tidyverse)
library(broom)
library(gtsummary)
library(flextable)
library(gt)
library(caret)
library(GGally)
data <- read_csv("data/fetal_health.csv")
full_data
0.25*dim(full_data)[1]
full_data <- read_csv("data/fetal_health.csv")
dim(full_data)[1]
0.25*dim(full_data)[1]
?ceiling
sample(1:dim(full_data)[1], size=ceiling(0.25*dim(full_data)[1]))
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.25*dim(full_data)[1])),]
full_data <- read_csv("data/fetal_health.csv")
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.25*dim(full_data)[1])),]
write_csv(x=partial_data, file="data/fetal_health_subset.csv")
partial_data$fetal_health
ftable(partial_data$fetal_health)
full_data <- read_csv("data/fetal_health.csv")
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.5*dim(full_data)[1])),]
write_csv(x=partial_data, file="data/fetal_health_subset.csv")
ftable(partial_data$fetal_health)
full_data <- read_csv("data/fetal_health.csv")
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.33*dim(full_data)[1])),]
write_csv(x=partial_data, file="data/fetal_health_subset.csv")
ftable(partial_data$fetal_health)
full_data <- read_csv("data/fetal_health.csv")
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.4*dim(full_data)[1])),]
write_csv(x=partial_data, file="data/fetal_health_subset.csv")
ftable(partial_data$fetal_health)
set.seed(12)
full_data <- read_csv("data/fetal_health.csv")
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.4*dim(full_data)[1])),]
write_csv(x=partial_data, file="data/fetal_health_subset.csv")
names(partial_data)
set.seed(12)
full_data <- read_csv("data/fetal_health.csv")
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.5*dim(full_data)[1])),]
write_csv(x=partial_data, file="data/fetal_health_subset.csv")
ftable(partial_data$fetal_health)
set.seed(12)
full_data <- read_csv("data/fetal_health.csv")
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.6*dim(full_data)[1])),]
write_csv(x=partial_data, file="data/fetal_health_subset.csv")
ftable(partial_data$fetal_health)
?train
train(data=partial_data, form=fetal_health~., method='knn', tuneLength = 20)
train(form=fetal_health~., data=partial_data, method='knn', tuneLength = 20)
train(form=factor(fetal_health)~., data=partial_data, method='knn', tuneLength = 20)
train_knn <- train(form=factor(fetal_health)~., data=partial_data, method='knn', tuneLength = 20)
partial_data$health_predict <- predict(train_knn)
predict(train_knn)
train_knn <- train(form=factor(fetal_health)~., data=partial_data, method='knn', tuneLength = 20)
plot(train_knn)
predict(train_knn, newdata = partial_data)
partial_data$health_predict <- predict(train_knn, newdata = partial_data)
?confusionMatrix
confusionMatrix(data=factor(partial_data$health_predict),
reference = factor(partial_data$fetal_health))
set.seed(12)
full_data <- read_csv("data/fetal_health.csv")
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.5*dim(full_data)[1])),]
write_csv(x=partial_data, file="data/fetal_health_subset.csv")
ftable(partial_data$fetal_health)
set.seed(12)
train_knn <- train(form=factor(fetal_health)~., data=partial_data, method='knn', tuneLength = 20)
plot(train_knn)
partial_data$health_predict <- predict(train_knn, newdata = partial_data)
confusionMatrix(data=factor(partial_data$health_predict),
reference = factor(partial_data$fetal_health))
set.seed(12)
fetal_data_tt_index <- createDataPartition(partial_data$fetal_health,
p=0.6, list = FALSE)
fetal_data_train <- partial_data[fetal_data_tt_index,]
fetal_data_test <- partial_data[-fetal_data_tt_index,]
train_knn <- train(form=factor(fetal_health)~., data=fetal_data_train, method='knn', tuneLength = 20)
plot(train_knn)
set.seed(12)
fetal_data_tt_index <- createDataPartition(partial_data$fetal_health,
p=0.6, list = FALSE)
fetal_data_train <- partial_data[fetal_data_tt_index,]
fetal_data_test <- partial_data[-fetal_data_tt_index,]
train_knn <- train(form=factor(fetal_health)~., data=fetal_data_train, method='knn', tuneLength = 20)
plot(train_knn)
fetal_data_test$health_predict <- predict(train_knn, newdata = fetal_data_test)
confusionMatrix(data=factor(fetal_data_test$health_predict),
reference = factor(fetal_data_test$fetal_health))
set.seed(12)
full_data <- read_csv("data/fetal_health.csv")
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.5*dim(full_data)[1])),]
write_csv(x=partial_data, file="data/fetal_health_subset.csv")
ftable(partial_data$fetal_health)
#set.seed(12)
fetal_data_tt_index <- createDataPartition(partial_data$fetal_health,
p=0.6, list = FALSE)
fetal_data_train <- partial_data[fetal_data_tt_index,]
fetal_data_test <- partial_data[-fetal_data_tt_index,]
train_knn <- train(form=factor(fetal_health)~., data=fetal_data_train, method='knn', tuneLength = 20)
plot(train_knn)
fetal_data_test$health_predict <- predict(train_knn, newdata = fetal_data_test)
confusionMatrix(data=factor(fetal_data_test$health_predict),
reference = factor(fetal_data_test$fetal_health))
#set.seed(12)
fetal_data_tt_index <- createDataPartition(partial_data$fetal_health,
p=0.6, list = FALSE)
fetal_data_train <- partial_data[fetal_data_tt_index,]
fetal_data_test <- partial_data[-fetal_data_tt_index,]
train_knn <- train(form=factor(fetal_health)~., data=fetal_data_train, method='knn', tuneLength = 20)
plot(train_knn)
fetal_data_test$health_predict <- predict(train_knn, newdata = fetal_data_test)
confusionMatrix(data=factor(fetal_data_test$health_predict),
reference = factor(fetal_data_test$fetal_health))
#set.seed(12)
fetal_data_tt_index <- createDataPartition(partial_data$fetal_health,
p=0.6, list = FALSE)
fetal_data_train <- partial_data[fetal_data_tt_index,]
fetal_data_test <- partial_data[-fetal_data_tt_index,]
train_knn <- train(form=factor(fetal_health)~., data=fetal_data_train, method='knn', tuneLength = 20)
plot(train_knn)
fetal_data_test$health_predict <- predict(train_knn, newdata = fetal_data_test)
confusionMatrix(data=factor(fetal_data_test$health_predict),
reference = factor(fetal_data_test$fetal_health))
set.seed(12)
full_data <- read_csv("data/fetal_health.csv")
partial_data <- full_data[sample(1:dim(full_data)[1], size=ceiling(0.35*dim(full_data)[1])),]
write_csv(x=partial_data, file="data/fetal_health_subset.csv")
ftable(partial_data$fetal_health)
#set.seed(12)
fetal_data_tt_index <- createDataPartition(partial_data$fetal_health,
p=0.6, list = FALSE)
fetal_data_train <- partial_data[fetal_data_tt_index,]
fetal_data_test <- partial_data[-fetal_data_tt_index,]
train_knn <- train(form=factor(fetal_health)~., data=fetal_data_train, method='knn', tuneLength = 20)
plot(train_knn)
fetal_data_test$health_predict <- predict(train_knn, newdata = fetal_data_test)
confusionMatrix(data=factor(fetal_data_test$health_predict),
reference = factor(fetal_data_test$fetal_health))
#set.seed(12)
fetal_data_tt_index <- createDataPartition(partial_data$fetal_health,
p=0.6, list = FALSE)
fetal_data_train <- partial_data[fetal_data_tt_index,]
fetal_data_test <- partial_data[-fetal_data_tt_index,]
train_knn <- train(form=factor(fetal_health)~., data=fetal_data_train, method='knn', tuneLength = 20)
plot(train_knn)
fetal_data_test$health_predict <- predict(train_knn, newdata = fetal_data_test)
confusionMatrix(data=factor(fetal_data_test$health_predict),
reference = factor(fetal_data_test$fetal_health))
#set.seed(12)
fetal_data_tt_index <- createDataPartition(partial_data$fetal_health,
p=0.6, list = FALSE)
fetal_data_train <- partial_data[fetal_data_tt_index,]
fetal_data_test <- partial_data[-fetal_data_tt_index,]
train_knn <- train(form=factor(fetal_health)~., data=fetal_data_train, method='knn', tuneLength = 20)
plot(train_knn)
fetal_data_test$health_predict <- predict(train_knn, newdata = fetal_data_test)
confusionMatrix(data=factor(fetal_data_test$health_predict),
reference = factor(fetal_data_test$fetal_health))
#set.seed(12)
fetal_data_tt_index <- createDataPartition(partial_data$fetal_health,
p=0.6, list = FALSE)
fetal_data_train <- partial_data[fetal_data_tt_index,]
fetal_data_test <- partial_data[-fetal_data_tt_index,]
train_knn <- train(form=factor(fetal_health)~., data=fetal_data_train, method='knn', tuneLength = 20)
plot(train_knn)
fetal_data_test$health_predict <- predict(train_knn, newdata = fetal_data_test)
confusionMatrix(data=factor(fetal_data_test$health_predict),
reference = factor(fetal_data_test$fetal_health))
ftable(partial_data$fetal_health)
